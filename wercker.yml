box: golang:latest
services:
  - id: mysql
    env:
      MYSQL_ROOT_PASSWORD: root
      MYSQL_USER: migorate
      MYSQL_PASSWORD: migorate
      MYSQL_DATABASE: migorate
build:
  steps:
    - glide-install
    - setup-go-workspace
    # - golint
    - script:
      name: set mysql host to env
      code: ./wercker_env.sh
    - script:
      name: go test
      code: go test $(go list ./... | grep -v /vendor/)
